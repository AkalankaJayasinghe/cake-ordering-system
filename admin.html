<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Cake Orders</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        .admin-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 2rem;
        }
        
        .admin-header {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .admin-header h1 {
            color: #1B1722;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-card i {
            font-size: 3rem;
            color: #bc5957;
            margin-bottom: 1rem;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1B1722;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 1.2rem;
        }
        
        .orders-table {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .table-header {
            background: #bc5957;
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .table-header h2 {
            margin: 0;
            font-size: 1.8rem;
        }
        
        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #1B1722;
        }
        
        .status-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-confirmed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-completed {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .btn-view {
            background: #17a2b8;
            color: white;
        }
        
        .btn-edit {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-delete {
            background: #dc3545;
            color: white;
        }
        
        .btn-small:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        @media (max-width: 768px) {
            .admin-container {
                padding: 1rem;
            }
            
            .table-responsive {
                overflow-x: auto;
            }
            
            table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1><i class="fas fa-tachometer-alt"></i> Cake Orders Admin Panel</h1>
            <p>Manage orders, track sales, and generate reports</p>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <i class="fas fa-shopping-cart"></i>
                <div class="stat-value" id="totalOrders">0</div>
                <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-dollar-sign"></i>
                <div class="stat-value" id="totalRevenue">Rs.0</div>
                <div class="stat-label">Total Revenue</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock"></i>
                <div class="stat-value" id="pendingOrders">0</div>
                <div class="stat-label">Pending Orders</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-chart-line"></i>
                <div class="stat-value" id="todayOrders">0</div>
                <div class="stat-label">Today's Orders</div>
            </div>
        </div>
        
        <!-- Orders Table -->
        <div class="orders-table">
            <div class="table-header">
                <h2><i class="fas fa-list"></i> Recent Orders</h2>
                <button class="export-btn" onclick="exportOrdersPDF()">
                    <i class="fas fa-file-pdf"></i> Export PDF Report
                </button>
            </div>
            <div class="table-responsive">
                <table id="ordersTable">
                    <thead>
                        <tr>
                            <th>Order #</th>
                            <th>Customer</th>
                            <th>Event</th>
                            <th>Cake Details</th>
                            <th>Delivery</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Load orders and statistics
        document.addEventListener('DOMContentLoaded', function() {
            loadStatistics();
            loadOrders();
        });

        function loadStatistics() {
            // Simulate loading statistics
            // In a real application, this would fetch from a PHP endpoint
            document.getElementById('totalOrders').textContent = '42';
            document.getElementById('totalRevenue').textContent = 'Rs.2,580';
            document.getElementById('pendingOrders').textContent = '8';
            document.getElementById('todayOrders').textContent = '5';
        }

        function loadOrders() {
            // Sample order data - in real app, this would come from PHP/database
            const sampleOrders = [
                {
                    id: 1,
                    customerName: 'John Doe',
                    email: 'john@example.com',
                    phone: '0751234567',
                    event: 'Birthday',
                    cakeSize: '1kg',
                    flavor: 'Chocolate',
                    decorations: 'Custom Message',
                    delivery: 'Standard',
                    deliveryDate: '2025-09-25',
                    total: 60.00,
                    status: 'pending',
                    orderDate: '2025-09-20'
                },
                {
                    id: 2,
                    customerName: 'Jane Smith',
                    email: 'jane@example.com',
                    phone: '0757891234',
                    event: 'Wedding',
                    cakeSize: '2kg',
                    flavor: 'Vanilla',
                    decorations: 'Fondant, Flowers',
                    delivery: 'Express',
                    deliveryDate: '2025-10-15',
                    total: 145.00,
                    status: 'confirmed',
                    orderDate: '2025-09-18'
                }
            ];

            const tableBody = document.getElementById('ordersTableBody');
            tableBody.innerHTML = '';

            sampleOrders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#${order.id}</td>
                    <td>
                        <strong>${order.customerName}</strong><br>
                        <small>${order.email}</small><br>
                        <small>${order.phone}</small>
                    </td>
                    <td>${order.event}</td>
                    <td>
                        ${order.cakeSize} ${order.flavor}<br>
                        <small>${order.decorations}</small>
                    </td>
                    <td>
                        ${order.delivery}<br>
                        <small>${order.deliveryDate}</small>
                    </td>
                    <td><strong>Rs.${order.total.toFixed(2)}</strong></td>
                    <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                    <td>${order.orderDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-small btn-view" onclick="viewOrder(${order.id})" title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-small btn-edit" onclick="editOrder(${order.id})" title="Edit Order">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-small btn-delete" onclick="deleteOrder(${order.id})" title="Delete Order">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function viewOrder(orderId) {
            alert(`Viewing order #${orderId}`);
            // In real app, open modal or navigate to order details page
        }

        function editOrder(orderId) {
            alert(`Editing order #${orderId}`);
            // In real app, open edit form
        }

        function deleteOrder(orderId) {
            if (confirm(`Are you sure you want to delete order #${orderId}?`)) {
                alert(`Order #${orderId} deleted`);
                // In real app, send delete request to server
                loadOrders(); // Refresh the table
            }
        }

        function exportOrdersPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Header
            doc.setFontSize(20);
            doc.setTextColor(188, 89, 87);
            doc.text('CAKE CRAVINGS', 105, 20, { align: 'center' });
            
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('Orders Report', 105, 30, { align: 'center' });
            
            // Current date
            doc.setFontSize(12);
            doc.text('Generated on: ' + new Date().toLocaleDateString(), 105, 40, { align: 'center' });
            
            // Line
            doc.setDrawColor(188, 89, 87);
            doc.setLineWidth(0.5);
            doc.line(20, 45, 190, 45);
            
            // Statistics
            let yPos = 60;
            doc.setFontSize(14);
            doc.setTextColor(188, 89, 87);
            doc.text('Summary Statistics:', 20, yPos);
            
            yPos += 15;
            doc.setFontSize(11);
            doc.setTextColor(0, 0, 0);
            doc.text('Total Orders: ' + document.getElementById('totalOrders').textContent, 20, yPos);
            doc.text('Total Revenue: ' + document.getElementById('totalRevenue').textContent, 70, yPos);
            doc.text('Pending Orders: ' + document.getElementById('pendingOrders').textContent, 130, yPos);
            
            yPos += 20;
            
            // Orders table header
            doc.setFontSize(14);
            doc.setTextColor(188, 89, 87);
            doc.text('Recent Orders:', 20, yPos);
            
            yPos += 15;
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            
            // Table headers
            doc.text('Order#', 20, yPos);
            doc.text('Customer', 40, yPos);
            doc.text('Event', 80, yPos);
            doc.text('Total', 110, yPos);
            doc.text('Status', 130, yPos);
            doc.text('Date', 160, yPos);
            
            yPos += 5;
            doc.line(20, yPos, 190, yPos);
            yPos += 10;
            
            // Sample order data for PDF
            const orders = [
                { id: 1, customer: 'John Doe', event: 'Birthday', total: 'Rs.60.00', status: 'Pending', date: '2025-09-20' },
                { id: 2, customer: 'Jane Smith', event: 'Wedding', total: 'Rs.145.00', status: 'Confirmed', date: '2025-09-18' }
            ];
            
            orders.forEach(order => {
                if (yPos > 270) { // Check if we need a new page
                    doc.addPage();
                    yPos = 20;
                }
                
                doc.text('#' + order.id, 20, yPos);
                doc.text(order.customer, 40, yPos);
                doc.text(order.event, 80, yPos);
                doc.text(order.total, 110, yPos);
                doc.text(order.status, 130, yPos);
                doc.text(order.date, 160, yPos);
                
                yPos += 12;
            });
            
            // Footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(100, 100, 100);
                doc.text('Cake Cravings Admin Report - Page ' + i + ' of ' + pageCount, 105, 285, { align: 'center' });
            }
            
            // Save PDF
            const fileName = 'Cake_Orders_Report_' + new Date().toISOString().split('T')[0] + '.pdf';
            doc.save(fileName);
        }
    </script>
</body>
</html>